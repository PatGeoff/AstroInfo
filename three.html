<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venus Phase from Montreal - November 13, 2024</title>
    <style>
        canvas { border: 1px solid black; display: block; margin: 20px auto; }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="400" height="400"></canvas>
    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        function drawVenusPhase() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const venusRadius = 80; // Radius of Venus in the display

            // // Data for November 13, 2024
            // const phi = 61.8172;   // Phase angle
            // const pabLon = 302.0527; // PAB-LON for orientation
            // const pabLat = -3.1979;  // PAB-LAT for tilt

             // Data for Sept 14, 2026
             const phi = 114.1587;   // Phase angle
            const pabLon = 269.3147; // PAB-LON for orientation
            const pabLat = -7.6242;  // PAB-LAT for tilt

            // Calculate the phase fraction (how much of Venus is illuminated)
            const phaseFraction = (1 + Math.cos(phi * (Math.PI / 180))) / 2;

            // Display the phase percentage and date
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText(`Phase: ${(phaseFraction * 100).toFixed(1)}%`, 10, 20);
            ctx.fillText(`Date: Nov 13, 2024`, 10, 40);
            
            // Draw the full Venus disk
            ctx.beginPath();
            ctx.arc(centerX, centerY, venusRadius, 0, Math.PI * 2); // Full disk of Venus
            ctx.fillStyle = 'beige'; // Venus's illuminated side color
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.stroke();

            // Calculate the shadow portion based on the phase and pabLon
            const shadowOffset = venusRadius * (1 - phaseFraction); // Offset for the shadow
            const tiltAngle = pabLon * (Math.PI / 180); // Convert PAB-LON to radians for rotation

            ctx.save(); // Save canvas state for transformation

            // Rotate canvas to simulate tilt + 90 degrees to account for the correct orientation
            const correctionAngle = Math.PI / 2;  // 90 degrees correction clockwise for proper display
            ctx.translate(centerX, centerY); // Move origin to center of Venus
            ctx.rotate(tiltAngle + correctionAngle); // Rotate the canvas with correction
            ctx.translate(-centerX, -centerY); // Move origin back

            // Draw the crescent shadow
            ctx.beginPath();
            ctx.arc(centerX - shadowOffset, centerY, venusRadius, Math.PI / 2, Math.PI * 3 / 2, false); // Crescent shadow
            ctx.fillStyle = 'black'; // Shadow side of Venus
            ctx.fill();

            ctx.restore(); // Restore the original canvas state
        }

        // Initial draw
        drawVenusPhase();
    </script>
</body>
</html>
